<!doctype html>
<html>
<head>
<title>/cluster/home/tgrosser/polly/llvm_git/tools/polly/lib/External/isl/isl_id.c</title>
<style type="text/css">
 body { color:#000000; background-color:#ffffff }
 body { font-family:Helvetica, sans-serif; font-size:10pt }
 h1 { font-size:14pt }
 .code { border-collapse:collapse; width:100%; }
 .code { font-family: "Monospace", monospace; font-size:10pt }
 .code { line-height: 1.2em }
 .comment { color: green; font-style: oblique }
 .keyword { color: blue }
 .string_literal { color: red }
 .directive { color: darkmagenta }
 .expansion { display: none; }
 .macro:hover .expansion { display: block; border: 2px solid #FF0000; padding: 2px; background-color:#FFF0F0; font-weight: normal;   -webkit-border-radius:5px;  -webkit-box-shadow:1px 1px 7px #000; position: absolute; top: -1em; left:10em; z-index: 1 } 
 .macro { color: darkmagenta; background-color:LemonChiffon; position: relative }
 .num { width:2.5em; padding-right:2ex; background-color:#eeeeee }
 .num { text-align:right; font-size:8pt }
 .num { color:#444444 }
 .line { padding-left: 1ex; border-left: 3px solid #ccc }
 .line { white-space: pre }
 .msg { -webkit-box-shadow:1px 1px 7px #000 }
 .msg { -webkit-border-radius:5px }
 .msg { font-family:Helvetica, sans-serif; font-size:8pt }
 .msg { float:left }
 .msg { padding:0.25em 1ex 0.25em 1ex }
 .msg { margin-top:10px; margin-bottom:10px }
 .msg { font-weight:bold }
 .msg { max-width:60em; word-wrap: break-word; white-space: pre-wrap }
 .msgT { padding:0x; spacing:0x }
 .msgEvent { background-color:#fff8b4; color:#000000 }
 .msgControl { background-color:#bbbbbb; color:#000000 }
 .mrange { background-color:#dfddf3 }
 .mrange { border-bottom:1px solid #6F9DBE }
 .PathIndex { font-weight: bold; padding:0px 5px; margin-right:5px; }
 .PathIndex { -webkit-border-radius:8px }
 .PathIndexEvent { background-color:#bfba87 }
 .PathIndexControl { background-color:#8c8c8c }
 .PathNav a { text-decoration:none; font-size: larger }
 .CodeInsertionHint { font-weight: bold; background-color: #10dd10 }
 .CodeRemovalHint { background-color:#de1010 }
 .CodeRemovalHint { border-bottom:1px solid #6F9DBE }
 table.simpletable {
   padding: 5px;
   font-size:12pt;
   margin:20px;
   border-collapse: collapse; border-spacing: 0px;
 }
 td.rowname {
   text-align:right; font-weight:bold; color:#444444;
   padding-right:2ex; }
</style>
</head>
<body>
<!-- BUGDESC Potential leak of an object -->

<!-- BUGTYPE Leak -->

<!-- BUGCATEGORY Memory (Core Foundation/Objective-C) -->

<!-- BUGFILE /cluster/home/tgrosser/polly/llvm_git/tools/polly/lib/External/isl/isl_id.c -->

<!-- FILENAME isl_id.c -->

<!-- FUNCTIONNAME isl_id_free -->

<!-- ISSUEHASHCONTENTOFLINEINCONTEXT f6b0b271296eab1c95ebeac47eb73604 -->

<!-- BUGLINE 204 -->

<!-- BUGCOLUMN 10 -->

<!-- BUGPATHLENGTH 4 -->

<!-- BUGMETAEND -->
<!-- REPORTHEADER -->
<h3>Bug Summary</h3>
<table class="simpletable">
<tr><td class="rowname">File:</td><td>External/isl/isl_id.c</td></tr>
<tr><td class="rowname">Location:</td><td><a href="#EndPath">line 204, column 10</a></td></tr>
<tr><td class="rowname">Description:</td><td>Potential leak of an object</td></tr>
<tr><td></td><td>Code is compiled to use reference counts</td></tr>
</table>
<!-- REPORTSUMMARYEXTRA -->
<h3>Annotated Source Code</h3>
<table class="code">
<tr><td class="num" id="LN1">1</td><td class="line"><span class='comment'>/*</span></td></tr>
<tr><td class="num" id="LN2">2</td><td class="line"> <span class='comment'>* Copyright 2008-2009 Katholieke Universiteit Leuven</span></td></tr>
<tr><td class="num" id="LN3">3</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr><td class="num" id="LN4">4</td><td class="line"> <span class='comment'>* Use of this software is governed by the MIT license</span></td></tr>
<tr><td class="num" id="LN5">5</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr><td class="num" id="LN6">6</td><td class="line"> <span class='comment'>* Written by Sven Verdoolaege, K.U.Leuven, Departement</span></td></tr>
<tr><td class="num" id="LN7">7</td><td class="line"> <span class='comment'>* Computerwetenschappen, Celestijnenlaan 200A, B-3001 Leuven, Belgium</span></td></tr>
<tr><td class="num" id="LN8">8</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr><td class="num" id="LN9">9</td><td class="line"> </td></tr>
<tr><td class="num" id="LN10">10</td><td class="line"><span class='directive'>#include &lt;string.h&gt;</span></td></tr>
<tr><td class="num" id="LN11">11</td><td class="line"><span class='directive'>#include &lt;isl_ctx_private.h&gt;</span></td></tr>
<tr><td class="num" id="LN12">12</td><td class="line"><span class='directive'>#include &lt;isl_id_private.h&gt;</span></td></tr>
<tr><td class="num" id="LN13">13</td><td class="line"> </td></tr>
<tr><td class="num" id="LN14">14</td><td class="line"><span class='directive'>#undef <span class='macro'>BASE<span class='expansion'>id</span></span></span></td></tr>
<tr><td class="num" id="LN15">15</td><td class="line"><span class='directive'>#define <span class='macro'>BASE<span class='expansion'>id</span></span> id</span></td></tr>
<tr><td class="num" id="LN16">16</td><td class="line"> </td></tr>
<tr><td class="num" id="LN17">17</td><td class="line"><span class='directive'>#include &lt;isl_list_templ.c&gt;</span></td></tr>
<tr><td class="num" id="LN18">18</td><td class="line"> </td></tr>
<tr><td class="num" id="LN19">19</td><td class="line"><span class='comment'>/* A special, static isl_id to use as domains (and ranges)</span></td></tr>
<tr><td class="num" id="LN20">20</td><td class="line"> <span class='comment'>* of sets and parameters domains.</span></td></tr>
<tr><td class="num" id="LN21">21</td><td class="line"> <span class='comment'>* The user should never get a hold on this isl_id.</span></td></tr>
<tr><td class="num" id="LN22">22</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr><td class="num" id="LN23">23</td><td class="line">isl_id isl_id_none = {</td></tr>
<tr><td class="num" id="LN24">24</td><td class="line">	.ref = -1,</td></tr>
<tr><td class="num" id="LN25">25</td><td class="line">	.ctx = <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>,</td></tr>
<tr><td class="num" id="LN26">26</td><td class="line">	.name = <span class='string_literal'>"#none"</span>,</td></tr>
<tr><td class="num" id="LN27">27</td><td class="line">	.user = <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span></td></tr>
<tr><td class="num" id="LN28">28</td><td class="line">};</td></tr>
<tr><td class="num" id="LN29">29</td><td class="line"> </td></tr>
<tr><td class="num" id="LN30">30</td><td class="line">isl_ctx *isl_id_get_ctx(__isl_keep isl_id *id)</td></tr>
<tr><td class="num" id="LN31">31</td><td class="line">{</td></tr>
<tr><td class="num" id="LN32">32</td><td class="line">	<span class='keyword'>return</span> id ? id-&gt;ctx : <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN33">33</td><td class="line">}</td></tr>
<tr><td class="num" id="LN34">34</td><td class="line"> </td></tr>
<tr><td class="num" id="LN35">35</td><td class="line"><span class='keyword'>void</span> *isl_id_get_user(__isl_keep isl_id *id)</td></tr>
<tr><td class="num" id="LN36">36</td><td class="line">{</td></tr>
<tr><td class="num" id="LN37">37</td><td class="line">	<span class='keyword'>return</span> id ? id-&gt;user : <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN38">38</td><td class="line">}</td></tr>
<tr><td class="num" id="LN39">39</td><td class="line"> </td></tr>
<tr><td class="num" id="LN40">40</td><td class="line"><span class='keyword'>const</span> <span class='keyword'>char</span> *isl_id_get_name(__isl_keep isl_id *id)</td></tr>
<tr><td class="num" id="LN41">41</td><td class="line">{</td></tr>
<tr><td class="num" id="LN42">42</td><td class="line">	<span class='keyword'>return</span> id ? id-&gt;name : <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN43">43</td><td class="line">}</td></tr>
<tr><td class="num" id="LN44">44</td><td class="line"> </td></tr>
<tr><td class="num" id="LN45">45</td><td class="line"><span class='keyword'>static</span> <span class='macro'>__isl_give<span class='expansion'>__attribute__((cf_returns_retained))</span></span> isl_id *id_alloc(isl_ctx *ctx, <span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>void</span> *user)</td></tr>
<tr><td class="num" id="LN46">46</td><td class="line">{</td></tr>
<tr><td class="num" id="LN47">47</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *copy = name ? <span class='macro'>strdup(name)<span class='expansion'>(__extension__ (__builtin_constant_p (name) &amp;&amp; ((size_t<br>)(const void *)((name) + 1) - (size_t)(const void *)(name) ==<br> 1) ? (((__const char *) (name))[0] == '\0' ? (char *) calloc<br> ((size_t) 1, (size_t) 1) : ({ size_t __len = strlen (name) +<br> 1; char *__retval = (char *) malloc (__len); if (__retval !=<br> ((void*)0)) __retval = (char *) memcpy (__retval, name, __len<br>); __retval; })) : __strdup (name)))</span></span> : <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN48">48</td><td class="line">	isl_id *id;</td></tr>
<tr><td class="num" id="LN49">49</td><td class="line"> </td></tr>
<tr><td class="num" id="LN50">50</td><td class="line">	<span class='keyword'>if</span> (name &amp;&amp; !copy)</td></tr>
<tr><td class="num" id="LN51">51</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN52">52</td><td class="line">	id = <span class='macro'>isl_calloc_type(ctx, <span class='keyword'>struct</span> isl_id)<span class='expansion'>((struct isl_id *)isl_calloc_or_die(ctx, 1, sizeof(struct isl_id<br>)))</span></span>;</td></tr>
<tr><td class="num" id="LN53">53</td><td class="line">	<span class='keyword'>if</span> (!id)</td></tr>
<tr><td class="num" id="LN54">54</td><td class="line">		<span class='keyword'>goto</span> error;</td></tr>
<tr><td class="num" id="LN55">55</td><td class="line"> </td></tr>
<tr><td class="num" id="LN56">56</td><td class="line">	id-&gt;ctx = ctx;</td></tr>
<tr><td class="num" id="LN57">57</td><td class="line">	isl_ctx_ref(id-&gt;ctx);</td></tr>
<tr><td class="num" id="LN58">58</td><td class="line">	id-&gt;ref = 1;</td></tr>
<tr><td class="num" id="LN59">59</td><td class="line">	id-&gt;name = copy;</td></tr>
<tr><td class="num" id="LN60">60</td><td class="line">	id-&gt;user = user;</td></tr>
<tr><td class="num" id="LN61">61</td><td class="line"> </td></tr>
<tr><td class="num" id="LN62">62</td><td class="line">	id-&gt;hash = <span class='macro'>isl_hash_init()<span class='expansion'>(2166136261u)</span></span>;</td></tr>
<tr><td class="num" id="LN63">63</td><td class="line">	<span class='keyword'>if</span> (name)</td></tr>
<tr><td class="num" id="LN64">64</td><td class="line">		id-&gt;hash = isl_hash_string(id-&gt;hash, name);</td></tr>
<tr><td class="num" id="LN65">65</td><td class="line">	<span class='keyword'>else</span></td></tr>
<tr><td class="num" id="LN66">66</td><td class="line">		id-&gt;hash = <span class='macro'>isl_hash_builtin(id-&gt;hash, user)<span class='expansion'>isl_hash_mem(id-&gt;hash, &amp;user, sizeof(user))</span></span>;</td></tr>
<tr><td class="num" id="LN67">67</td><td class="line"> </td></tr>
<tr><td class="num" id="LN68">68</td><td class="line">	<span class='keyword'>return</span> id;</td></tr>
<tr><td class="num" id="LN69">69</td><td class="line">error:</td></tr>
<tr><td class="num" id="LN70">70</td><td class="line">	free((<span class='keyword'>char</span> *)copy);</td></tr>
<tr><td class="num" id="LN71">71</td><td class="line">	<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN72">72</td><td class="line">}</td></tr>
<tr><td class="num" id="LN73">73</td><td class="line"> </td></tr>
<tr><td class="num" id="LN74">74</td><td class="line">uint32_t isl_id_get_hash(__isl_keep isl_id *id)</td></tr>
<tr><td class="num" id="LN75">75</td><td class="line">{</td></tr>
<tr><td class="num" id="LN76">76</td><td class="line">	<span class='keyword'>return</span> id ? id-&gt;hash : 0;</td></tr>
<tr><td class="num" id="LN77">77</td><td class="line">}</td></tr>
<tr><td class="num" id="LN78">78</td><td class="line"> </td></tr>
<tr><td class="num" id="LN79">79</td><td class="line"><span class='keyword'>struct</span> isl_name_and_user {</td></tr>
<tr><td class="num" id="LN80">80</td><td class="line">	<span class='keyword'>const</span> <span class='keyword'>char</span> *name;</td></tr>
<tr><td class="num" id="LN81">81</td><td class="line">	<span class='keyword'>void</span> *user;</td></tr>
<tr><td class="num" id="LN82">82</td><td class="line">};</td></tr>
<tr><td class="num" id="LN83">83</td><td class="line"> </td></tr>
<tr><td class="num" id="LN84">84</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>int</span> isl_id_has_name_and_user(<span class='keyword'>const</span> <span class='keyword'>void</span> *entry, <span class='keyword'>const</span> <span class='keyword'>void</span> *val)</td></tr>
<tr><td class="num" id="LN85">85</td><td class="line">{</td></tr>
<tr><td class="num" id="LN86">86</td><td class="line">	isl_id *id = (isl_id *)entry;</td></tr>
<tr><td class="num" id="LN87">87</td><td class="line">	<span class='keyword'>struct</span> isl_name_and_user *nu = (<span class='keyword'>struct</span> isl_name_and_user *) val;</td></tr>
<tr><td class="num" id="LN88">88</td><td class="line"> </td></tr>
<tr><td class="num" id="LN89">89</td><td class="line">	<span class='keyword'>if</span> (id-&gt;user != nu-&gt;user)</td></tr>
<tr><td class="num" id="LN90">90</td><td class="line">		<span class='keyword'>return</span> 0;</td></tr>
<tr><td class="num" id="LN91">91</td><td class="line">	<span class='keyword'>if</span> (id-&gt;name == nu-&gt;name)</td></tr>
<tr><td class="num" id="LN92">92</td><td class="line">		<span class='keyword'>return</span> 1;</td></tr>
<tr><td class="num" id="LN93">93</td><td class="line">	<span class='keyword'>if</span> (!id-&gt;name || !nu-&gt;name)</td></tr>
<tr><td class="num" id="LN94">94</td><td class="line">		<span class='keyword'>return</span> 0;</td></tr>
<tr><td class="num" id="LN95">95</td><td class="line"> </td></tr>
<tr><td class="num" id="LN96">96</td><td class="line">	<span class='keyword'>return</span> !<span class='macro'>strcmp(id-&gt;name, nu-&gt;name)<span class='expansion'>__extension__ ({ size_t __s1_len, __s2_len; (__builtin_constant_p<br> (id-&gt;name) &amp;&amp; __builtin_constant_p (nu-&gt;name) &amp;&amp;<br> (__s1_len = strlen (id-&gt;name), __s2_len = strlen (nu-&gt;<br>name), (!((size_t)(const void *)((id-&gt;name) + 1) - (size_t<br>)(const void *)(id-&gt;name) == 1) || __s1_len &gt;= 4) &amp;&amp;<br> (!((size_t)(const void *)((nu-&gt;name) + 1) - (size_t)(const<br> void *)(nu-&gt;name) == 1) || __s2_len &gt;= 4)) ? __builtin_strcmp<br> (id-&gt;name, nu-&gt;name) : (__builtin_constant_p (id-&gt;name<br>) &amp;&amp; ((size_t)(const void *)((id-&gt;name) + 1) - (size_t<br>)(const void *)(id-&gt;name) == 1) &amp;&amp; (__s1_len = strlen<br> (id-&gt;name), __s1_len &lt; 4) ? (__builtin_constant_p (nu-&gt;<br>name) &amp;&amp; ((size_t)(const void *)((nu-&gt;name) + 1) -<br> (size_t)(const void *)(nu-&gt;name) == 1) ? __builtin_strcmp<br> (id-&gt;name, nu-&gt;name) : (__extension__ ({ __const unsigned<br> char *__s2 = (__const unsigned char *) (__const char *) (nu-&gt;<br>name); register int __result = (((__const unsigned char *) (__const<br> char *) (id-&gt;name))[0] - __s2[0]); if (__s1_len &gt; 0 &amp;&amp;<br> __result == 0) { __result = (((__const unsigned char *) (__const<br> char *) (id-&gt;name))[1] - __s2[1]); if (__s1_len &gt; 1 &amp;&amp;<br> __result == 0) { __result = (((__const unsigned char *) (__const<br> char *) (id-&gt;name))[2] - __s2[2]); if (__s1_len &gt; 2 &amp;&amp;<br> __result == 0) __result = (((__const unsigned char *) (__const<br> char *) (id-&gt;name))[3] - __s2[3]); } } __result; }))) : (<br>__builtin_constant_p (nu-&gt;name) &amp;&amp; ((size_t)(const<br> void *)((nu-&gt;name) + 1) - (size_t)(const void *)(nu-&gt;name<br>) == 1) &amp;&amp; (__s2_len = strlen (nu-&gt;name), __s2_len<br> &lt; 4) ? (__builtin_constant_p (id-&gt;name) &amp;&amp; ((size_t<br>)(const void *)((id-&gt;name) + 1) - (size_t)(const void *)(id<br>-&gt;name) == 1) ? __builtin_strcmp (id-&gt;name, nu-&gt;name<br>) : (__extension__ ({ __const unsigned char *__s1 = (__const unsigned<br> char *) (__const char *) (id-&gt;name); register int __result<br> = __s1[0] - ((__const unsigned char *) (__const char *) (nu-&gt;<br>name))[0]; if (__s2_len &gt; 0 &amp;&amp; __result == 0) { __result<br> = (__s1[1] - ((__const unsigned char *) (__const char *) (nu<br>-&gt;name))[1]); if (__s2_len &gt; 1 &amp;&amp; __result == 0<br>) { __result = (__s1[2] - ((__const unsigned char *) (__const<br> char *) (nu-&gt;name))[2]); if (__s2_len &gt; 2 &amp;&amp; __result<br> == 0) __result = (__s1[3] - ((__const unsigned char *) (__const<br> char *) (nu-&gt;name))[3]); } } __result; }))) : __builtin_strcmp<br> (id-&gt;name, nu-&gt;name)))); })</span></span>;</td></tr>
<tr><td class="num" id="LN97">97</td><td class="line">}</td></tr>
<tr><td class="num" id="LN98">98</td><td class="line"> </td></tr>
<tr><td class="num" id="LN99">99</td><td class="line"><span class='macro'>__isl_give<span class='expansion'>__attribute__((cf_returns_retained))</span></span> isl_id *isl_id_alloc(isl_ctx *ctx, <span class='keyword'>const</span> <span class='keyword'>char</span> *name, <span class='keyword'>void</span> *user)</td></tr>
<tr><td class="num" id="LN100">100</td><td class="line">{</td></tr>
<tr><td class="num" id="LN101">101</td><td class="line">	<span class='keyword'>struct</span> isl_hash_table_entry *entry;</td></tr>
<tr><td class="num" id="LN102">102</td><td class="line">	uint32_t id_hash;</td></tr>
<tr><td class="num" id="LN103">103</td><td class="line">	<span class='keyword'>struct</span> isl_name_and_user nu = { name, user };</td></tr>
<tr><td class="num" id="LN104">104</td><td class="line"> </td></tr>
<tr><td class="num" id="LN105">105</td><td class="line">	<span class='keyword'>if</span> (!ctx)</td></tr>
<tr><td class="num" id="LN106">106</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN107">107</td><td class="line"> </td></tr>
<tr><td class="num" id="LN108">108</td><td class="line">	id_hash = <span class='macro'>isl_hash_init()<span class='expansion'>(2166136261u)</span></span>;</td></tr>
<tr><td class="num" id="LN109">109</td><td class="line">	<span class='keyword'>if</span> (name)</td></tr>
<tr><td class="num" id="LN110">110</td><td class="line">		id_hash = isl_hash_string(id_hash, name);</td></tr>
<tr><td class="num" id="LN111">111</td><td class="line">	<span class='keyword'>else</span></td></tr>
<tr><td class="num" id="LN112">112</td><td class="line">		id_hash = <span class='macro'>isl_hash_builtin(id_hash, user)<span class='expansion'>isl_hash_mem(id_hash, &amp;user, sizeof(user))</span></span>;</td></tr>
<tr><td class="num" id="LN113">113</td><td class="line">	entry = isl_hash_table_find(ctx, &amp;ctx-&gt;id_table, id_hash,</td></tr>
<tr><td class="num" id="LN114">114</td><td class="line">					isl_id_has_name_and_user, &amp;nu, 1);</td></tr>
<tr><td class="num" id="LN115">115</td><td class="line">	<span class='keyword'>if</span> (!entry)</td></tr>
<tr><td class="num" id="LN116">116</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN117">117</td><td class="line">	<span class='keyword'>if</span> (entry-&gt;data)</td></tr>
<tr><td class="num" id="LN118">118</td><td class="line">		<span class='keyword'>return</span> isl_id_copy(entry-&gt;data);</td></tr>
<tr><td class="num" id="LN119">119</td><td class="line">	entry-&gt;data = id_alloc(ctx, name, user);</td></tr>
<tr><td class="num" id="LN120">120</td><td class="line">	<span class='keyword'>if</span> (!entry-&gt;data)</td></tr>
<tr><td class="num" id="LN121">121</td><td class="line">		ctx-&gt;id_table.n--;</td></tr>
<tr><td class="num" id="LN122">122</td><td class="line">	<span class='keyword'>return</span> entry-&gt;data;</td></tr>
<tr><td class="num" id="LN123">123</td><td class="line">}</td></tr>
<tr><td class="num" id="LN124">124</td><td class="line"> </td></tr>
<tr><td class="num" id="LN125">125</td><td class="line"><span class='comment'>/* If the id has a negative refcount, then it is a static isl_id</span></td></tr>
<tr><td class="num" id="LN126">126</td><td class="line"> <span class='comment'>* which should not be changed.</span></td></tr>
<tr><td class="num" id="LN127">127</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr><td class="num" id="LN128">128</td><td class="line"><span class='macro'>__isl_give<span class='expansion'>__attribute__((cf_returns_retained))</span></span> isl_id *isl_id_copy(isl_id *id)</td></tr>
<tr><td class="num" id="LN129">129</td><td class="line">{</td></tr>
<tr><td class="num" id="LN130">130</td><td class="line">	<span class='keyword'>if</span> (!id)</td></tr>
<tr><td class="num" id="LN131">131</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN132">132</td><td class="line"> </td></tr>
<tr><td class="num" id="LN133">133</td><td class="line">	<span class='keyword'>if</span> (id-&gt;ref &lt; 0)</td></tr>
<tr><td class="num" id="LN134">134</td><td class="line">		<span class='keyword'>return</span> id;</td></tr>
<tr><td class="num" id="LN135">135</td><td class="line"> </td></tr>
<tr><td class="num" id="LN136">136</td><td class="line">	id-&gt;ref++;</td></tr>
<tr><td class="num" id="LN137">137</td><td class="line">	<span class='keyword'>return</span> id;</td></tr>
<tr><td class="num" id="LN138">138</td><td class="line">}</td></tr>
<tr><td class="num" id="LN139">139</td><td class="line"> </td></tr>
<tr><td class="num" id="LN140">140</td><td class="line"><span class='comment'>/* Compare two isl_ids.</span></td></tr>
<tr><td class="num" id="LN141">141</td><td class="line"> <span class='comment'>*</span></td></tr>
<tr><td class="num" id="LN142">142</td><td class="line"> <span class='comment'>* The order is fairly arbitrary.  We do keep the comparison of</span></td></tr>
<tr><td class="num" id="LN143">143</td><td class="line"> <span class='comment'>* the user pointers as a last resort since these pointer values</span></td></tr>
<tr><td class="num" id="LN144">144</td><td class="line"> <span class='comment'>* may not be stable across different systems or even different runs.</span></td></tr>
<tr><td class="num" id="LN145">145</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr><td class="num" id="LN146">146</td><td class="line"><span class='keyword'>int</span> isl_id_cmp(__isl_keep isl_id *id1, __isl_keep isl_id *id2)</td></tr>
<tr><td class="num" id="LN147">147</td><td class="line">{</td></tr>
<tr><td class="num" id="LN148">148</td><td class="line">	<span class='keyword'>if</span> (id1 == id2)</td></tr>
<tr><td class="num" id="LN149">149</td><td class="line">		<span class='keyword'>return</span> 0;</td></tr>
<tr><td class="num" id="LN150">150</td><td class="line">	<span class='keyword'>if</span> (!id1)</td></tr>
<tr><td class="num" id="LN151">151</td><td class="line">		<span class='keyword'>return</span> -1;</td></tr>
<tr><td class="num" id="LN152">152</td><td class="line">	<span class='keyword'>if</span> (!id2)</td></tr>
<tr><td class="num" id="LN153">153</td><td class="line">		<span class='keyword'>return</span> 1;</td></tr>
<tr><td class="num" id="LN154">154</td><td class="line">	<span class='keyword'>if</span> (!id1-&gt;name != !id2-&gt;name)</td></tr>
<tr><td class="num" id="LN155">155</td><td class="line">		<span class='keyword'>return</span> !id1-&gt;name - !id2-&gt;name;</td></tr>
<tr><td class="num" id="LN156">156</td><td class="line">	<span class='keyword'>if</span> (id1-&gt;name) {</td></tr>
<tr><td class="num" id="LN157">157</td><td class="line">		<span class='keyword'>int</span> cmp = <span class='macro'>strcmp(id1-&gt;name, id2-&gt;name)<span class='expansion'>__extension__ ({ size_t __s1_len, __s2_len; (__builtin_constant_p<br> (id1-&gt;name) &amp;&amp; __builtin_constant_p (id2-&gt;name<br>) &amp;&amp; (__s1_len = strlen (id1-&gt;name), __s2_len = strlen<br> (id2-&gt;name), (!((size_t)(const void *)((id1-&gt;name) + 1<br>) - (size_t)(const void *)(id1-&gt;name) == 1) || __s1_len &gt;=<br> 4) &amp;&amp; (!((size_t)(const void *)((id2-&gt;name) + 1) -<br> (size_t)(const void *)(id2-&gt;name) == 1) || __s2_len &gt;=<br> 4)) ? __builtin_strcmp (id1-&gt;name, id2-&gt;name) : (__builtin_constant_p<br> (id1-&gt;name) &amp;&amp; ((size_t)(const void *)((id1-&gt;name<br>) + 1) - (size_t)(const void *)(id1-&gt;name) == 1) &amp;&amp;<br> (__s1_len = strlen (id1-&gt;name), __s1_len &lt; 4) ? (__builtin_constant_p<br> (id2-&gt;name) &amp;&amp; ((size_t)(const void *)((id2-&gt;name<br>) + 1) - (size_t)(const void *)(id2-&gt;name) == 1) ? __builtin_strcmp<br> (id1-&gt;name, id2-&gt;name) : (__extension__ ({ __const unsigned<br> char *__s2 = (__const unsigned char *) (__const char *) (id2<br>-&gt;name); register int __result = (((__const unsigned char *<br>) (__const char *) (id1-&gt;name))[0] - __s2[0]); if (__s1_len<br> &gt; 0 &amp;&amp; __result == 0) { __result = (((__const unsigned<br> char *) (__const char *) (id1-&gt;name))[1] - __s2[1]); if (<br>__s1_len &gt; 1 &amp;&amp; __result == 0) { __result = (((__const<br> unsigned char *) (__const char *) (id1-&gt;name))[2] - __s2[<br>2]); if (__s1_len &gt; 2 &amp;&amp; __result == 0) __result =<br> (((__const unsigned char *) (__const char *) (id1-&gt;name))<br>[3] - __s2[3]); } } __result; }))) : (__builtin_constant_p (id2<br>-&gt;name) &amp;&amp; ((size_t)(const void *)((id2-&gt;name) +<br> 1) - (size_t)(const void *)(id2-&gt;name) == 1) &amp;&amp; (<br>__s2_len = strlen (id2-&gt;name), __s2_len &lt; 4) ? (__builtin_constant_p<br> (id1-&gt;name) &amp;&amp; ((size_t)(const void *)((id1-&gt;name<br>) + 1) - (size_t)(const void *)(id1-&gt;name) == 1) ? __builtin_strcmp<br> (id1-&gt;name, id2-&gt;name) : (__extension__ ({ __const unsigned<br> char *__s1 = (__const unsigned char *) (__const char *) (id1<br>-&gt;name); register int __result = __s1[0] - ((__const unsigned<br> char *) (__const char *) (id2-&gt;name))[0]; if (__s2_len &gt;<br> 0 &amp;&amp; __result == 0) { __result = (__s1[1] - ((__const<br> unsigned char *) (__const char *) (id2-&gt;name))[1]); if (__s2_len<br> &gt; 1 &amp;&amp; __result == 0) { __result = (__s1[2] - ((__const<br> unsigned char *) (__const char *) (id2-&gt;name))[2]); if (__s2_len<br> &gt; 2 &amp;&amp; __result == 0) __result = (__s1[3] - ((__const<br> unsigned char *) (__const char *) (id2-&gt;name))[3]); } } __result<br>; }))) : __builtin_strcmp (id1-&gt;name, id2-&gt;name)))); })</span></span>;</td></tr>
<tr><td class="num" id="LN158">158</td><td class="line">		<span class='keyword'>if</span> (cmp != 0)</td></tr>
<tr><td class="num" id="LN159">159</td><td class="line">			<span class='keyword'>return</span> cmp;</td></tr>
<tr><td class="num" id="LN160">160</td><td class="line">	}</td></tr>
<tr><td class="num" id="LN161">161</td><td class="line">	<span class='keyword'>if</span> (id1-&gt;user &lt; id2-&gt;user)</td></tr>
<tr><td class="num" id="LN162">162</td><td class="line">		<span class='keyword'>return</span> -1;</td></tr>
<tr><td class="num" id="LN163">163</td><td class="line">	<span class='keyword'>else</span></td></tr>
<tr><td class="num" id="LN164">164</td><td class="line">		<span class='keyword'>return</span> 1;</td></tr>
<tr><td class="num" id="LN165">165</td><td class="line">}</td></tr>
<tr><td class="num" id="LN166">166</td><td class="line"> </td></tr>
<tr><td class="num" id="LN167">167</td><td class="line"><span class='keyword'>static</span> <span class='keyword'>int</span> isl_id_eq(<span class='keyword'>const</span> <span class='keyword'>void</span> *entry, <span class='keyword'>const</span> <span class='keyword'>void</span> *name)</td></tr>
<tr><td class="num" id="LN168">168</td><td class="line">{</td></tr>
<tr><td class="num" id="LN169">169</td><td class="line">	<span class='keyword'>return</span> entry == name;</td></tr>
<tr><td class="num" id="LN170">170</td><td class="line">}</td></tr>
<tr><td class="num" id="LN171">171</td><td class="line"> </td></tr>
<tr><td class="num" id="LN172">172</td><td class="line">uint32_t isl_hash_id(uint32_t hash, __isl_keep isl_id *id)</td></tr>
<tr><td class="num" id="LN173">173</td><td class="line">{</td></tr>
<tr><td class="num" id="LN174">174</td><td class="line">	<span class='keyword'>if</span> (id)</td></tr>
<tr><td class="num" id="LN175">175</td><td class="line">		<span class='macro'>isl_hash_hash(hash, id-&gt;hash)<span class='expansion'>do { do { hash *= 16777619; hash ^= (id-&gt;hash) &amp; 0xFF;<br> } while(0); do { hash *= 16777619; hash ^= ((id-&gt;hash) &gt;&gt;<br> 8) &amp; 0xFF; } while(0); do { hash *= 16777619; hash ^= ((<br>id-&gt;hash) &gt;&gt; 16) &amp; 0xFF; } while(0); do { hash *=<br> 16777619; hash ^= ((id-&gt;hash) &gt;&gt; 24) &amp; 0xFF; } while<br>(0); } while(0)</span></span>;</td></tr>
<tr><td class="num" id="LN176">176</td><td class="line"> </td></tr>
<tr><td class="num" id="LN177">177</td><td class="line">	<span class='keyword'>return</span> hash;</td></tr>
<tr><td class="num" id="LN178">178</td><td class="line">}</td></tr>
<tr><td class="num" id="LN179">179</td><td class="line"> </td></tr>
<tr><td class="num" id="LN180">180</td><td class="line"><span class='comment'>/* Replace the free_user callback by "free_user".</span></td></tr>
<tr><td class="num" id="LN181">181</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr><td class="num" id="LN182">182</td><td class="line"><span class='macro'>__isl_give<span class='expansion'>__attribute__((cf_returns_retained))</span></span> isl_id *isl_id_set_free_user(<span class='macro'>__isl_take<span class='expansion'>__attribute__((cf_consumed))</span></span> isl_id *id,</td></tr>
<tr><td class="num" id="LN183">183</td><td class="line">	<span class='keyword'>void</span> (*free_user)(<span class='keyword'>void</span> *user))</td></tr>
<tr><td class="num" id="LN184">184</td><td class="line">{</td></tr>
<tr><td class="num" id="LN185">185</td><td class="line">	<span class='keyword'>if</span> (!id)</td></tr>
<tr><td class="num" id="LN186">186</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN187">187</td><td class="line"> </td></tr>
<tr><td class="num" id="LN188">188</td><td class="line">	id-&gt;free_user = free_user;</td></tr>
<tr><td class="num" id="LN189">189</td><td class="line"> </td></tr>
<tr><td class="num" id="LN190">190</td><td class="line">	<span class='keyword'>return</span> id;</td></tr>
<tr><td class="num" id="LN191">191</td><td class="line">}</td></tr>
<tr><td class="num" id="LN192">192</td><td class="line"> </td></tr>
<tr><td class="num" id="LN193">193</td><td class="line"><span class='comment'>/* If the id has a negative refcount, then it is a static isl_id</span></td></tr>
<tr><td class="num" id="LN194">194</td><td class="line"> <span class='comment'>* and should not be freed.</span></td></tr>
<tr><td class="num" id="LN195">195</td><td class="line"> <span class='comment'>*/</span></td></tr>
<tr><td class="num" id="LN196">196</td><td class="line">__isl_null isl_id *isl_id_free(<span class='macro'>__isl_take<span class='expansion'>__attribute__((cf_consumed))</span></span> isl_id *id)</td></tr>
<tr><td class="num" id="LN197">197</td><td class="line">{</td></tr>
<tr><td class="num" id="LN198">198</td><td class="line">	<span class='keyword'>struct</span> isl_hash_table_entry *entry;</td></tr>
<tr><td class="num" id="LN199">199</td><td class="line"> </td></tr>
<tr><td class="num" id="LN200">200</td><td class="line">	<span class='keyword'>if</span> (<span class="mrange">!id</span>)</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path1" class="msg msgEvent" style="margin-left:13ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">1</div></td><td>Assuming 'id' is non-null</td><td><div class="PathNav"><a href="#Path2" title="Next event (2)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num"></td><td class="line"><div id="Path2" class="msg msgControl" style="margin-left:9ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">2</div></td><td><div class="PathNav"><a href="#Path1" title="Previous event (1)">&#x2190;</a></div></td></td><td>Taking false branch</td><td><div class="PathNav"><a href="#Path3" title="Next event (3)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num" id="LN201">201</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN202">202</td><td class="line"> </td></tr>
<tr><td class="num" id="LN203">203</td><td class="line">	<span class='keyword'>if</span> (id-&gt;ref &lt; 0)</td></tr>
<tr><td class="num"></td><td class="line"><div id="Path3" class="msg msgControl" style="margin-left:9ex"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">3</div></td><td><div class="PathNav"><a href="#Path2" title="Previous event (2)">&#x2190;</a></div></td></td><td>Taking true branch</td><td><div class="PathNav"><a href="#EndPath" title="Next event (4)">&#x2192;</a></div></td></tr></table></div></td></tr>
<tr><td class="num" id="LN204">204</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num"></td><td class="line"><div id="EndPath" class="msg msgControl" style="margin-left:24ex; max-width:100em"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexControl">4</div></td><td><div class="PathNav"><a href="#Path3" title="Previous event (3)">&#x2190;</a></div></td></td><td>Within the expansion of the macro 'NULL':
</td></tr></table><div class="msg msgEvent" style="width:94%; margin-left:5px"><table class="msgT"><tr><td valign="top"><div class="PathIndex PathIndexEvent">a</div></td><td valign="top">Object leaked: allocated object is not referenced later in this execution path and has a retain count of +1</td></tr></table></div>
</div></td></tr>
<tr><td class="num" id="LN205">205</td><td class="line"> </td></tr>
<tr><td class="num" id="LN206">206</td><td class="line">	<span class='keyword'>if</span> (--id-&gt;ref &gt; 0)</td></tr>
<tr><td class="num" id="LN207">207</td><td class="line">		<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN208">208</td><td class="line"> </td></tr>
<tr><td class="num" id="LN209">209</td><td class="line">	entry = isl_hash_table_find(id-&gt;ctx, &amp;id-&gt;ctx-&gt;id_table, id-&gt;hash,</td></tr>
<tr><td class="num" id="LN210">210</td><td class="line">					isl_id_eq, id, 0);</td></tr>
<tr><td class="num" id="LN211">211</td><td class="line">	<span class='keyword'>if</span> (!entry)</td></tr>
<tr><td class="num" id="LN212">212</td><td class="line">		<span class='macro'>isl_die(id-&gt;ctx, isl_error_unknown,<span class='expansion'>do { isl_handle_error(id-&gt;ctx, isl_error_unknown, "unable to find id"<br>, "/cluster/home/tgrosser/polly/llvm_git/tools/polly/lib/External/isl/isl_id.c"<br>, 213); (void)0; } while (0)</span></span></td></tr>
<tr><td class="num" id="LN213">213</td><td class="line">			<span class='string_literal'><span class='macro'>"unable to find id"</span>, (<span class='keyword'>void</span>)0)<span class='expansion'>do { isl_handle_error(id-&gt;ctx, isl_error_unknown, "unable to find id"<br>, "/cluster/home/tgrosser/polly/llvm_git/tools/polly/lib/External/isl/isl_id.c"<br>, 213); (void)0; } while (0)</span></span>;</td></tr>
<tr><td class="num" id="LN214">214</td><td class="line">	<span class='keyword'>else</span></td></tr>
<tr><td class="num" id="LN215">215</td><td class="line">		isl_hash_table_remove(id-&gt;ctx, &amp;id-&gt;ctx-&gt;id_table, entry);</td></tr>
<tr><td class="num" id="LN216">216</td><td class="line"> </td></tr>
<tr><td class="num" id="LN217">217</td><td class="line">	<span class='keyword'>if</span> (id-&gt;free_user)</td></tr>
<tr><td class="num" id="LN218">218</td><td class="line">		id-&gt;free_user(id-&gt;user);</td></tr>
<tr><td class="num" id="LN219">219</td><td class="line"> </td></tr>
<tr><td class="num" id="LN220">220</td><td class="line">	free((<span class='keyword'>char</span> *)id-&gt;name);</td></tr>
<tr><td class="num" id="LN221">221</td><td class="line">	isl_ctx_deref(id-&gt;ctx);</td></tr>
<tr><td class="num" id="LN222">222</td><td class="line">	free(id);</td></tr>
<tr><td class="num" id="LN223">223</td><td class="line"> </td></tr>
<tr><td class="num" id="LN224">224</td><td class="line">	<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN225">225</td><td class="line">}</td></tr>
<tr><td class="num" id="LN226">226</td><td class="line"> </td></tr>
<tr><td class="num" id="LN227">227</td><td class="line"><span class='macro'>__isl_give<span class='expansion'>__attribute__((cf_returns_retained))</span></span> isl_printer *isl_printer_print_id(<span class='macro'>__isl_take<span class='expansion'>__attribute__((cf_consumed))</span></span> isl_printer *p,</td></tr>
<tr><td class="num" id="LN228">228</td><td class="line">	__isl_keep isl_id *id)</td></tr>
<tr><td class="num" id="LN229">229</td><td class="line">{</td></tr>
<tr><td class="num" id="LN230">230</td><td class="line">	<span class='keyword'>if</span> (!id)</td></tr>
<tr><td class="num" id="LN231">231</td><td class="line">		<span class='keyword'>goto</span> error;</td></tr>
<tr><td class="num" id="LN232">232</td><td class="line"> </td></tr>
<tr><td class="num" id="LN233">233</td><td class="line">	<span class='keyword'>if</span> (id-&gt;name)</td></tr>
<tr><td class="num" id="LN234">234</td><td class="line">		p = isl_printer_print_str(p, id-&gt;name);</td></tr>
<tr><td class="num" id="LN235">235</td><td class="line">	<span class='keyword'>if</span> (id-&gt;user) {</td></tr>
<tr><td class="num" id="LN236">236</td><td class="line">		<span class='keyword'>char</span> buffer[50];</td></tr>
<tr><td class="num" id="LN237">237</td><td class="line">		snprintf(buffer, <span class='keyword'>sizeof</span>(buffer), <span class='string_literal'>"@%p"</span>, id-&gt;user);</td></tr>
<tr><td class="num" id="LN238">238</td><td class="line">		p = isl_printer_print_str(p, buffer);</td></tr>
<tr><td class="num" id="LN239">239</td><td class="line">	}</td></tr>
<tr><td class="num" id="LN240">240</td><td class="line">	<span class='keyword'>return</span> p;</td></tr>
<tr><td class="num" id="LN241">241</td><td class="line">error:</td></tr>
<tr><td class="num" id="LN242">242</td><td class="line">	isl_printer_free(p);</td></tr>
<tr><td class="num" id="LN243">243</td><td class="line">	<span class='keyword'>return</span> <span class='macro'>NULL<span class='expansion'>((void*)0)</span></span>;</td></tr>
<tr><td class="num" id="LN244">244</td><td class="line">}</td></tr>
</table></body></html>
